<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìã Prescri√ß√£o M√©dica - Lopes Souza Sa√∫de</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/css/prescricao-medica.css" rel="stylesheet">
    <link href="/css/watermark.css" rel="stylesheet">
    <style>
        /* Header para navega√ß√£o (n√£o imprime) */
        .page-header {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            text-decoration: none;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        @media print {
            .page-header {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Header de navega√ß√£o (n√£o imprime) -->
    <header class="page-header no-print">
        <div class="header-content">
            <h1 class="page-title">
                <i class="fas fa-prescription"></i>
                Prescri√ß√£o M√©dica
            </h1>
            <a href="/app.html" class="nav-btn">
                <i class="fas fa-arrow-left"></i>
                Voltar ao Dashboard
            </a>
        </div>
    </header>

    <!-- Bot√µes de controle (n√£o imprimem) -->
    <div class="control-buttons no-print">
        <button class="btn-fill" onclick="fillSampleData()">üìù Exemplo 1</button>
        <button class="btn-fill" onclick="fillSampleData2()" style="background: #28a745;">üìù Exemplo 2</button>
        <button class="btn-clear" onclick="clearForm()">üóëÔ∏è Limpar</button>
        <button class="btn-print" onclick="safePrint()">üñ®Ô∏è Imprimir</button>
        <button class="btn-print" onclick="window.print()" style="background: #ffc107; color: #333;" title="Impress√£o direta sem valida√ß√£o">‚ö° Impress√£o Direta</button>
        <button class="btn-clear" onclick="testPrint()" style="background: #17a2b8; color: white;" title="Testar impress√£o com diagn√≥stico">üîß Diagn√≥stico</button>
        <button class="btn-clear" onclick="debugFields()" style="background: #6f42c1; color: white; font-size: 12px;" title="Debug t√©cnico">üêõ Debug</button>
        <button class="btn-clear" onclick="toggleWatermark()" style="background: #fd7e14; color: white; font-size: 12px;" title="Alternar marca d'√°gua">üíß Marca D'√°gua</button>
    </div>

    <!-- Marcas d'√°gua para impress√£o (invis√≠veis na tela) -->
    <div id="watermark-main" class="watermark">LOPES SOUZA SA√öDE</div>
    <div id="watermark-logo" class="watermark-logo">üè•<br>LSS<br>MEDICINA</div>
    <div id="watermark-bordered" class="watermark-bordered">PRESCRI√á√ÉO OFICIAL</div>
    <div id="watermark-stamp" class="watermark-stamp">DOCUMENTO<br>M√âDICO<br>OFICIAL<br>LSS</div>
    <div id="watermark-pattern" class="watermark-pattern"></div>
    <div id="watermark-svg" class="watermark-svg"></div>

    <!-- Cabe√ßalho da Cl√≠nica -->
    <div class="clinic-header">
        <div class="clinic-logo">
            üè• LSS
        </div>
        <div class="clinic-info">
            <h1>Lopes Souza Sa√∫de</h1>
            <p class="subtitle">Excel√™ncia em Cuidados M√©dicos</p>
            <p>CNPJ: 12.345.678/0001-90 | Telefone: (85) 3456-7890</p>
            <p>Endere√ßo: Av. Dom Lu√≠s, 1200 - Meireles, Fortaleza - CE, 60160-230</p>
            <p>Email: contato@lopessouzasaude.com.br | Site: www.lopessouzasaude.com.br</p>
        </div>
    </div>

    <!-- Informa√ß√µes do M√©dico -->
    <div class="doctor-info">
        <div class="field-group">
            <label for="doctorName" class="required">Nome do M√©dico</label>
            <input type="text" id="doctorName" class="field-value" placeholder="Dr(a). Nome Completo">
        </div>
        <div class="field-group">
            <label for="doctorCrm" class="required">CRM</label>
            <input type="text" id="doctorCrm" class="field-value" placeholder="CRM/CE 12345">
        </div>
        <div class="field-group">
            <label for="doctorSpecialty">Especialidade</label>
            <input type="text" id="doctorSpecialty" class="field-value" placeholder="Especialidade M√©dica">
        </div>
        <div class="field-group">
            <label for="prescriptionDate" class="required">Data da Prescri√ß√£o</label>
            <input type="date" id="prescriptionDate" class="field-value">
        </div>
    </div>

    <!-- Informa√ß√µes do Paciente -->
    <div class="patient-info">
        <h3>üë§ Dados do Paciente</h3>
        <div class="patient-grid">
            <div class="form-field">
                <label for="patientName" class="required">Nome Completo</label>
                <input type="text" id="patientName" placeholder="Nome completo do paciente">
            </div>
            <div class="form-field">
                <label for="patientAge" class="required">Idade</label>
                <input type="number" id="patientAge" placeholder="Idade" min="0" max="150">
            </div>
            <div class="form-field">
                <label for="patientWeight">Peso (kg)</label>
                <input type="number" id="patientWeight" placeholder="Peso" step="0.1">
            </div>
        </div>
        <div class="patient-grid-2">
            <div class="form-field">
                <label for="patientCpf">CPF</label>
                <input type="text" id="patientCpf" placeholder="000.000.000-00">
            </div>
            <div class="form-field">
                <label for="patientPhone">Telefone</label>
                <input type="tel" id="patientPhone" placeholder="(85) 9 9999-9999">
            </div>
            <div class="form-field">
                <label for="patientGender">Sexo</label>
                <select id="patientGender">
                    <option value="">Selecione</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                    <option value="O">Outro</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Prescri√ß√£o M√©dica -->
    <div class="prescription-content">
        <h3>üíä Prescri√ß√£o M√©dica</h3>
        
        <!-- Medicamento 1 -->
        <div class="medication-item">
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <span class="medication-number">1</span>
                <strong style="color: #dc3545;">MEDICAMENTO</strong>
            </div>
            <div class="medication-header">
                <div class="form-field">
                    <label class="required">Nome do Medicamento</label>
                    <input type="text" placeholder="Nome do medicamento + concentra√ß√£o">
                </div>
                <div class="form-field">
                    <label class="required">Quantidade</label>
                    <input type="text" placeholder="Ex: 30 comprimidos">
                </div>
                <div class="form-field">
                    <label>Via de Administra√ß√£o</label>
                    <select>
                        <option value="">Selecione</option>
                        <option value="oral">Via Oral</option>
                        <option value="sublingual">Sublingual</option>
                        <option value="intramuscular">Intramuscular</option>
                        <option value="endovenosa">Endovenosa</option>
                        <option value="topica">T√≥pica</option>
                        <option value="inalatoria">Inalat√≥ria</option>
                        <option value="ocular">Ocular</option>
                        <option value="nasal">Nasal</option>
                        <option value="retal">Retal</option>
                        <option value="vaginal">Vaginal</option>
                    </select>
                </div>
            </div>
            <div class="medication-instructions">
                <label class="required">Posologia e Instru√ß√µes de Uso</label>
                <textarea placeholder="Ex: Tomar 1 comprimido de 12 em 12 horas, por 7 dias. Tomar ap√≥s as refei√ß√µes com √°gua. N√£o interromper o tratamento sem orienta√ß√£o m√©dica."></textarea>
            </div>
        </div>

        <!-- Medicamento 2 -->
        <div class="medication-item">
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <span class="medication-number">2</span>
                <strong style="color: #dc3545;">MEDICAMENTO</strong>
            </div>
            <div class="medication-header">
                <div class="form-field">
                    <label>Nome do Medicamento</label>
                    <input type="text" placeholder="Nome do medicamento + concentra√ß√£o">
                </div>
                <div class="form-field">
                    <label>Quantidade</label>
                    <input type="text" placeholder="Ex: 60 c√°psulas">
                </div>
                <div class="form-field">
                    <label>Via de Administra√ß√£o</label>
                    <select>
                        <option value="">Selecione</option>
                        <option value="oral">Via Oral</option>
                        <option value="sublingual">Sublingual</option>
                        <option value="intramuscular">Intramuscular</option>
                        <option value="endovenosa">Endovenosa</option>
                        <option value="topica">T√≥pica</option>
                        <option value="inalatoria">Inalat√≥ria</option>
                        <option value="ocular">Ocular</option>
                        <option value="nasal">Nasal</option>
                        <option value="retal">Retal</option>
                        <option value="vaginal">Vaginal</option>
                    </select>
                </div>
            </div>
            <div class="medication-instructions">
                <label>Posologia e Instru√ß√µes de Uso</label>
                <textarea placeholder="Ex: Tomar 1 c√°psula pela manh√£, em jejum, por 30 dias."></textarea>
            </div>
        </div>

        <!-- Medicamento 3 -->
        <div class="medication-item">
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <span class="medication-number">3</span>
                <strong style="color: #dc3545;">MEDICAMENTO</strong>
            </div>
            <div class="medication-header">
                <div class="form-field">
                    <label>Nome do Medicamento</label>
                    <input type="text" placeholder="Nome do medicamento + concentra√ß√£o">
                </div>
                <div class="form-field">
                    <label>Quantidade</label>
                    <input type="text" placeholder="Ex: 1 frasco">
                </div>
                <div class="form-field">
                    <label>Via de Administra√ß√£o</label>
                    <select>
                        <option value="">Selecione</option>
                        <option value="oral">Via Oral</option>
                        <option value="sublingual">Sublingual</option>
                        <option value="intramuscular">Intramuscular</option>
                        <option value="endovenosa">Endovenosa</option>
                        <option value="topica">T√≥pica</option>
                        <option value="inalatoria">Inalat√≥ria</option>
                        <option value="ocular">Ocular</option>
                        <option value="nasal">Nasal</option>
                        <option value="retal">Retal</option>
                        <option value="vaginal">Vaginal</option>
                    </select>
                </div>
            </div>
            <div class="medication-instructions">
                <label>Posologia e Instru√ß√µes de Uso</label>
                <textarea placeholder="Ex: Aplicar 2 gotas em cada olho, 2 vezes ao dia."></textarea>
            </div>
        </div>
    </div>

    <!-- Orienta√ß√µes Gerais -->
    <div class="general-instructions">
        <h3>üìã Orienta√ß√µes Gerais ao Paciente</h3>
        <textarea placeholder="Ex: 
‚Ä¢ Manter medicamentos longe do alcance de crian√ßas
‚Ä¢ Armazenar em local seco e arejado
‚Ä¢ Retornar em 15 dias para reavalia√ß√£o
‚Ä¢ Em caso de efeitos adversos, suspender uso e procurar atendimento m√©dico
‚Ä¢ N√£o compartilhar medicamentos com outras pessoas
‚Ä¢ Levar esta receita em todas as consultas"></textarea>
        <p class="required-note">* Campos obrigat√≥rios</p>
    </div>

    <!-- Se√ß√£o de Assinaturas -->
    <div class="signature-section">
        <div class="signature-grid">
            <div class="signature-block">
                <div class="signature-line"></div>
                <div class="signature-label">Assinatura e Carimbo do M√©dico</div>
                <div class="signature-info">
                    Nome: <span id="doctorNameSign">_______________________</span><br>
                    CRM: <span id="doctorCrmSign">_____________</span><br>
                    Data: <span id="prescriptionDateSign">___/___/______</span>
                </div>
            </div>
            <div class="signature-block">
                <div class="signature-line"></div>
                <div class="signature-label">Ciente - Paciente ou Respons√°vel</div>
                <div class="signature-info">
                    Nome: <span id="patientNameSign">_______________________</span><br>
                    CPF: <span id="patientCpfSign">_________________</span><br>
                    Data: ___/___/______
                </div>
            </div>
        </div>
    </div>

    <!-- Rodap√© Informativo -->
    <div class="footer-info">
        <div class="warning">‚ö†Ô∏è PRESCRI√á√ÉO M√âDICA - DOCUMENTO OFICIAL</div>
        <p>Esta prescri√ß√£o √© v√°lida em todo territ√≥rio nacional por 30 dias a partir da data de emiss√£o.</p>
        <p>Medicamentos controlados t√™m validade espec√≠fica conforme legisla√ß√£o vigente.</p>
        <p>Em caso de d√∫vidas, entre em contato com a Lopes Souza Sa√∫de: (85) 3456-7890</p>
        <p><strong>Gerado pelo Sistema MediApp v3.0.0 - Lopes Souza Sa√∫de</strong></p>
    </div>

    <script>
        // Definir data atual
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('prescriptionDate').value = today;
            
            // Ativar marca d'√°gua padr√£o (LOPES SOUZA SA√öDE)
            currentWatermark = 1;
            console.log('üíß Marca d\'√°gua padr√£o ativada: LOPES SOUZA SA√öDE');
        });

        // Fun√ß√£o para preencher dados de exemplo
        function fillSampleData() {
            // Dados do m√©dico - mais realistas
            document.getElementById('doctorName').value = 'Dr. Carlos Eduardo Mendon√ßa Filho';
            document.getElementById('doctorCrm').value = 'CRM/CE 8547';
            document.getElementById('doctorSpecialty').value = 'Medicina Interna e Cl√≠nica M√©dica';
            
            // Dados do paciente - mais realistas
            document.getElementById('patientName').value = 'Ana Beatriz Santos Ferreira';
            document.getElementById('patientAge').value = '38';
            document.getElementById('patientWeight').value = '72.3';
            document.getElementById('patientCpf').value = '456.789.123-45';
            document.getElementById('patientPhone').value = '(85) 9 9876-5432';
            document.getElementById('patientGender').value = 'F';
            
            // Medicamentos - prescri√ß√£o realista para quadro infeccioso
            const medications = document.querySelectorAll('.medication-item');
            
            // Medicamento 1 - Antibi√≥tico
            const med1 = medications[0];
            med1.querySelectorAll('input')[0].value = 'Amoxicilina + √Åcido Clavul√¢nico 875mg + 125mg';
            med1.querySelectorAll('input')[1].value = '14 comprimidos revestidos';
            med1.querySelector('select').value = 'oral';
            med1.querySelector('textarea').value = 'Tomar 1 comprimido de 12 em 12 horas por 7 dias, preferencialmente ap√≥s as refei√ß√µes principais (almo√ßo e jantar). N√£o interromper o tratamento mesmo que haja melhora dos sintomas. Ingerir com abundante quantidade de √°gua. Em caso de esquecimento, tomar assim que lembrar, mas se estiver pr√≥ximo do hor√°rio da pr√≥xima dose, pular a dose esquecida.';
            
            // Medicamento 2 - Analg√©sico/Antit√©rmico
            const med2 = medications[1];
            med2.querySelectorAll('input')[0].value = 'Paracetamol 750mg';
            med2.querySelectorAll('input')[1].value = '20 comprimidos';
            med2.querySelector('select').value = 'oral';
            med2.querySelector('textarea').value = 'Tomar 1 comprimido de 6 em 6 horas se dor ou febre (m√°ximo 4 comprimidos por dia). Pode ser tomado com ou sem alimentos. N√£o exceder a dose m√°xima di√°ria de 3g (4 comprimidos). Suspender o uso se houver melhora completa dos sintomas.';
            
            // Medicamento 3 - Probi√≥tico
            const med3 = medications[2];
            med3.querySelectorAll('input')[0].value = 'Saccharomyces boulardii 200mg';
            med3.querySelectorAll('input')[1].value = '10 c√°psulas';
            med3.querySelector('select').value = 'oral';
            med3.querySelector('textarea').value = 'Tomar 1 c√°psula de 12 em 12 horas durante todo o per√≠odo de uso do antibi√≥tico e por mais 3 dias ap√≥s o t√©rmino. Tomar com √°gua em temperatura ambiente, preferencialmente com o est√¥mago vazio (1 hora antes ou 2 horas ap√≥s as refei√ß√µes). Manter refrigerado ap√≥s abertura da embalagem.';
            
            // Orienta√ß√µes gerais - mais detalhadas e realistas
            document.querySelector('.general-instructions textarea').value = `ORIENTA√á√ïES IMPORTANTES:

üìã SOBRE OS MEDICAMENTOS:
‚Ä¢ Manter todos os medicamentos em local seco, arejado e protegido da luz solar direta
‚Ä¢ Armazenar em temperatura ambiente (15¬∞C a 30¬∞C)
‚Ä¢ Manter sempre longe do alcance de crian√ßas e animais dom√©sticos
‚Ä¢ Verificar prazo de validade antes do uso
‚Ä¢ N√£o compartilhar medicamentos com outras pessoas

‚ö†Ô∏è DURANTE O TRATAMENTO:
‚Ä¢ Evitar consumo de bebidas alco√≥licas durante todo o per√≠odo de tratamento
‚Ä¢ Manter alimenta√ß√£o leve e rica em l√≠quidos
‚Ä¢ Aumentar a ingest√£o de √°gua (m√≠nimo 2 litros por dia)
‚Ä¢ Evitar alimentos muito condimentados ou gordurosos
‚Ä¢ Respeitar os hor√°rios prescritos para melhor efic√°cia

üè• RETORNO E ACOMPANHAMENTO:
‚Ä¢ Retornar em 5 dias para reavalia√ß√£o do quadro cl√≠nico
‚Ä¢ Procurar atendimento m√©dico imediatamente se houver piora dos sintomas
‚Ä¢ Em caso de febre persistente acima de 38,5¬∞C por mais de 48h ap√≥s in√≠cio do tratamento
‚Ä¢ Se apresentar efeitos adversos como: erup√ß√µes cut√¢neas, dificuldade respirat√≥ria, incha√ßo facial

üì± CONTATO DE EMERG√äNCIA:
‚Ä¢ Lopes Souza Sa√∫de: (85) 3456-7890 (24h)
‚Ä¢ Em caso de urg√™ncia: UPA ou Pronto Socorro mais pr√≥ximo

‚úÖ SINAIS DE MELHORA ESPERADOS:
‚Ä¢ Redu√ß√£o da febre em 48-72 horas
‚Ä¢ Diminui√ß√£o da dor em 24-48 horas  
‚Ä¢ Melhora do estado geral em 3-5 dias

Esta receita √© v√°lida por 30 dias. Levar sempre nas consultas de acompanhamento.`;

            // Atualizar campos de assinatura
            updateSignatureFields();
            
            // Notificar que os dados foram preenchidos
            alert('üìã Exemplo preenchido com sucesso!\n\n‚úÖ Dados realistas do m√©dico\n‚úÖ Informa√ß√µes completas do paciente\n‚úÖ Prescri√ß√£o para quadro infeccioso\n‚úÖ Orienta√ß√µes m√©dicas detalhadas\n\nAgora voc√™ pode testar a impress√£o.');
        }

        // Fun√ß√£o para preencher segundo exemplo - Cardiologia
        function fillSampleData2() {
            // Dados do m√©dico - Cardiologista
            document.getElementById('doctorName').value = 'Dra. Mariana Rodrigues Cardoso';
            document.getElementById('doctorCrm').value = 'CRM/CE 12439';
            document.getElementById('doctorSpecialty').value = 'Cardiologia';
            
            // Dados do paciente - Hipertens√£o
            document.getElementById('patientName').value = 'Jos√© Roberto Silva Junior';
            document.getElementById('patientAge').value = '58';
            document.getElementById('patientWeight').value = '89.2';
            document.getElementById('patientCpf').value = '789.123.456-78';
            document.getElementById('patientPhone').value = '(85) 9 8234-5679';
            document.getElementById('patientGender').value = 'M';
            
            // Medicamentos - prescri√ß√£o para hipertens√£o e preven√ß√£o cardiovascular
            const medications = document.querySelectorAll('.medication-item');
            
            // Medicamento 1 - Anti-hipertensivo
            const med1 = medications[0];
            med1.querySelectorAll('input')[0].value = 'Losartana Pot√°ssica 50mg';
            med1.querySelectorAll('input')[1].value = '30 comprimidos revestidos';
            med1.querySelector('select').value = 'oral';
            med1.querySelector('textarea').value = 'Tomar 1 comprimido pela manh√£, sempre no mesmo hor√°rio, com ou sem alimentos. Preferencialmente √†s 8h da manh√£. N√£o interromper o uso sem orienta√ß√£o m√©dica. Em caso de esquecimento, tomar assim que lembrar, mas se faltar menos de 12 horas para a pr√≥xima dose, pular a dose esquecida. Manter uso cont√≠nuo.';
            
            // Medicamento 2 - Protetor g√°strico
            const med2 = medications[1];
            med2.querySelectorAll('input')[0].value = 'Omeprazol 20mg';
            med2.querySelectorAll('input')[1].value = '30 c√°psulas';
            med2.querySelector('select').value = 'oral';
            med2.querySelector('textarea').value = 'Tomar 1 c√°psula pela manh√£, 30-60 minutos antes do caf√© da manh√£, em jejum. Engolir inteira sem mastigar ou abrir. Uso cont√≠nuo por 30 dias para prote√ß√£o g√°strica. Pode ser tomado com pouca √°gua.';
            
            // Medicamento 3 - √Åcido acetilsalic√≠lico
            const med3 = medications[2];
            med3.querySelectorAll('input')[0].value = '√Åcido Acetilsalic√≠lico 100mg (AAS)';
            med3.querySelectorAll('input')[1].value = '30 comprimidos';
            med3.querySelector('select').value = 'oral';
            med3.querySelector('textarea').value = 'Tomar 1 comprimido √† noite, ap√≥s o jantar, para prote√ß√£o cardiovascular. Uso cont√≠nuo conforme orienta√ß√£o m√©dica. Tomar sempre com alimentos para evitar irrita√ß√£o g√°strica. Em caso de sangramento anormal ou hematomas excessivos, suspender uso e procurar atendimento m√©dico.';
            
            // Orienta√ß√µes gerais - foco em cardiologia
            document.querySelector('.general-instructions textarea').value = `ORIENTA√á√ïES PARA CONTROLE DA PRESS√ÉO ARTERIAL:

üíä SOBRE OS MEDICAMENTOS:
‚Ä¢ Tomar sempre nos hor√°rios prescritos para manter controle adequado da press√£o
‚Ä¢ Nunca interromper o uso sem orienta√ß√£o m√©dica
‚Ä¢ Manter medicamentos em local seco e temperatura ambiente
‚Ä¢ N√£o compartilhar medicamentos com outras pessoas
‚Ä¢ Levar lista de medicamentos em todas as consultas

üìä MONITORAMENTO:
‚Ä¢ Medir a press√£o arterial 2x por semana (manh√£ e noite)
‚Ä¢ Anotar os valores em caderno para mostrar na consulta
‚Ä¢ Valores ideais: at√© 130/80 mmHg
‚Ä¢ Procurar atendimento se press√£o acima de 180/110 mmHg

üçé ESTILO DE VIDA:
‚Ä¢ Dieta com baixo teor de sal (m√°ximo 5g por dia = 1 colher de ch√°)
‚Ä¢ Evitar alimentos industrializados e enlatados
‚Ä¢ Aumentar consumo de frutas, verduras e legumes
‚Ä¢ Caminhada leve 30 minutos, 3x por semana (se liberada)
‚Ä¢ Manter peso adequado

‚ö†Ô∏è SINAIS DE ALERTA (procurar atendimento imediato):
‚Ä¢ Dor no peito ou aperto no peito
‚Ä¢ Falta de ar intensa
‚Ä¢ Dor de cabe√ßa severa
‚Ä¢ Tonturas ou desmaios
‚Ä¢ Incha√ßo nas pernas, p√©s ou tornozelos
‚Ä¢ Palpita√ß√µes frequentes

üö´ EVITAR:
‚Ä¢ Bebidas alco√≥licas (m√°ximo 1 dose social eventualmente)
‚Ä¢ Cigarro e derivados
‚Ä¢ Excesso de cafe√≠na
‚Ä¢ Estresse excessivo
‚Ä¢ Exerc√≠cios intensos sem libera√ß√£o m√©dica

üìÖ PR√ìXIMA CONSULTA:
‚Ä¢ Retorno em 30 dias para avalia√ß√£o e ajuste de medica√ß√£o
‚Ä¢ Trazer anota√ß√µes da press√£o arterial
‚Ä¢ Exames de controle conforme solicita√ß√£o

üÜò EMERG√äNCIA CARDIOL√ìGICA: 
‚Ä¢ Hospital do Cora√ß√£o: (85) 3456-7890
‚Ä¢ SAMU: 192
‚Ä¢ Em caso de infarto: ligar 192 e mascar 1 AAS 500mg`;

            // Atualizar campos de assinatura
            updateSignatureFields();
            
            // Notificar que os dados foram preenchidos
            alert('üíó Exemplo 2 preenchido com sucesso!\n\n‚úÖ Prescri√ß√£o cardiol√≥gica\n‚úÖ Controle de hipertens√£o\n‚úÖ Prote√ß√£o cardiovascular\n‚úÖ Orienta√ß√µes espec√≠ficas\n\nPrescri√ß√£o para paciente hipertenso com orienta√ß√µes detalhadas.');
        }

        // Fun√ß√£o para limpar formul√°rio
        function clearForm() {
            if (confirm('Tem certeza que deseja limpar todos os campos?')) {
                // Limpar inputs
                document.querySelectorAll('input, select, textarea').forEach(field => {
                    if (field.type === 'date') {
                        field.value = new Date().toISOString().split('T')[0];
                    } else {
                        field.value = '';
                    }
                });
                
                // Limpar campos de assinatura
                document.getElementById('doctorNameSign').textContent = '_______________________';
                document.getElementById('doctorCrmSign').textContent = '_____________';
                document.getElementById('prescriptionDateSign').textContent = '___/___/______';
                document.getElementById('patientNameSign').textContent = '_______________________';
                document.getElementById('patientCpfSign').textContent = '_________________';
            }
        }

        // Fun√ß√£o para atualizar campos de assinatura
        function updateSignatureFields() {
            const doctorName = document.getElementById('doctorName').value;
            const doctorCrm = document.getElementById('doctorCrm').value;
            const prescriptionDate = document.getElementById('prescriptionDate').value;
            const patientName = document.getElementById('patientName').value;
            const patientCpf = document.getElementById('patientCpf').value;
            
            if (doctorName) {
                document.getElementById('doctorNameSign').textContent = doctorName;
            }
            if (doctorCrm) {
                document.getElementById('doctorCrmSign').textContent = doctorCrm;
            }
            if (prescriptionDate) {
                const date = new Date(prescriptionDate);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
                document.getElementById('prescriptionDateSign').textContent = formattedDate;
            }
            if (patientName) {
                document.getElementById('patientNameSign').textContent = patientName;
            }
            if (patientCpf) {
                document.getElementById('patientCpfSign').textContent = patientCpf;
            }
        }

        // Atualizar campos de assinatura em tempo real
        document.getElementById('doctorName').addEventListener('input', updateSignatureFields);
        document.getElementById('doctorCrm').addEventListener('input', updateSignatureFields);
        document.getElementById('prescriptionDate').addEventListener('change', updateSignatureFields);
        document.getElementById('patientName').addEventListener('input', updateSignatureFields);
        document.getElementById('patientCpf').addEventListener('input', updateSignatureFields);

        // Formata√ß√£o autom√°tica do CPF
        document.getElementById('patientCpf').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = value;
        });

        // Formata√ß√£o autom√°tica do telefone
        document.getElementById('patientPhone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d)(\d{4})(\d)/, '$1 $2-$3');
            e.target.value = value;
        });

        // Valida√ß√£o e impress√£o segura
        function safePrint() {
            console.log('üîç Iniciando valida√ß√£o para impress√£o...');
            
            // Validar campos b√°sicos do m√©dico
            const doctorName = document.getElementById('doctorName').value.trim();
            const doctorCrm = document.getElementById('doctorCrm').value.trim();
            const prescriptionDate = document.getElementById('prescriptionDate').value;
            
            // Validar campos b√°sicos do paciente
            const patientName = document.getElementById('patientName').value.trim();
            const patientAge = document.getElementById('patientAge').value.trim();
            
            const missingFields = [];
            
            if (!doctorName) missingFields.push('Nome do M√©dico');
            if (!doctorCrm) missingFields.push('CRM do M√©dico');
            if (!prescriptionDate) missingFields.push('Data da Prescri√ß√£o');
            if (!patientName) missingFields.push('Nome do Paciente');
            if (!patientAge) missingFields.push('Idade do Paciente');
            
            // Validar se h√° pelo menos um medicamento prescrito
            const hasValidMedication = validateMedications();
            if (!hasValidMedication) {
                missingFields.push('Pelo menos um medicamento completo (nome, quantidade e posologia)');
            }
            
            if (missingFields.length > 0) {
                alert('‚ö†Ô∏è Campos obrigat√≥rios n√£o preenchidos:\n\n‚Ä¢ ' + missingFields.join('\n‚Ä¢ ') + '\n\nüí° Dica: Use os bot√µes "Exemplo 1" ou "Exemplo 2" para preencher automaticamente, ou preencha manualmente os campos obrigat√≥rios.');
                return false;
            }
            
            // Confirma√ß√£o antes da impress√£o
            const confirmMessage = `üìã CONFIRMAR IMPRESS√ÉO DA PRESCRI√á√ÉO M√âDICA

‚úÖ Dados validados:
‚Ä¢ M√©dico: ${doctorName}
‚Ä¢ CRM: ${doctorCrm}
‚Ä¢ Paciente: ${patientName}
‚Ä¢ Idade: ${patientAge} anos
‚Ä¢ Medicamentos: ${countValidMedications()} prescrito(s)

Proceder com a impress√£o?`;

            if (confirm(confirmMessage)) {
                console.log('‚úÖ Valida√ß√£o bem-sucedida. Iniciando impress√£o...');
                setTimeout(() => {
                    window.print();
                }, 500);
                return true;
            }
            return false;
        }

        // Fun√ß√£o adicional para validar medicamentos
        function validateMedications() {
            const medications = document.querySelectorAll('.medication-item');
            let hasValidMedication = false;
            
            medications.forEach((medication, index) => {
                const inputs = medication.querySelectorAll('input');
                const nameInput = inputs[0]; // Primeiro input √© o nome
                const quantityInput = inputs[1]; // Segundo input √© a quantidade
                const select = medication.querySelector('select');
                const textarea = medication.querySelector('textarea');
                
                console.log(`Medicamento ${index + 1}:`, {
                    nome: nameInput?.value || 'vazio',
                    quantidade: quantityInput?.value || 'vazio',
                    via: select?.value || 'vazio',
                    posologia: textarea?.value || 'vazio'
                });
                
                if (nameInput?.value.trim() && 
                    quantityInput?.value.trim() && 
                    textarea?.value.trim()) {
                    hasValidMedication = true;
                }
            });
            
            console.log('üîç Tem medicamento v√°lido:', hasValidMedication);
            return hasValidMedication;
        }

        // Fun√ß√£o para contar medicamentos v√°lidos
        function countValidMedications() {
            const medications = document.querySelectorAll('.medication-item');
            let count = 0;
            
            medications.forEach(medication => {
                const inputs = medication.querySelectorAll('input');
                const nameInput = inputs[0];
                const quantityInput = inputs[1];
                const textarea = medication.querySelector('textarea');
                
                if (nameInput?.value.trim() && 
                    quantityInput?.value.trim() && 
                    textarea?.value.trim()) {
                    count++;
                }
            });
            
            return count;
        }

        // Fun√ß√£o de verifica√ß√£o de impressora
        function checkPrinterStatus() {
            // Verificar se h√° impressoras dispon√≠veis (apenas em navegadores compat√≠veis)
            if ('navigator' in window && 'mediaDevices' in navigator) {
                console.log('üì± API de m√≠dia dispon√≠vel');
            }
            
            // Verificar configura√ß√µes de p√°gina
            const pageInfo = {
                width: window.innerWidth,
                height: window.innerHeight,
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language
            };
            
            console.log('ÔøΩ Informa√ß√µes da p√°gina:', pageInfo);
            
            // Dicas para o usu√°rio
            const tips = `
üñ®Ô∏è DICAS PARA IMPRESS√ÉO:

1. CONFIGURA√á√ÉO DA IMPRESSORA:
   ‚Ä¢ Verifique se a impressora est√° ligada e conectada
   ‚Ä¢ Teste imprimir uma p√°gina de teste do Windows
   ‚Ä¢ Verifique se h√° papel e tinta/toner

2. CONFIGURA√á√ïES DO NAVEGADOR:
   ‚Ä¢ Chrome: Ctrl+P ‚Üí Verificar destino
   ‚Ä¢ Firefox: Ctrl+P ‚Üí Verificar impressora selecionada
   ‚Ä¢ Edge: Ctrl+P ‚Üí Mais configura√ß√µes

3. FORMATO DO PAPEL:
   ‚Ä¢ Selecionar A4 (210x297mm)
   ‚Ä¢ Margens: Normais ou M√≠nimas
   ‚Ä¢ Orienta√ß√£o: Retrato

4. RESOLU√á√ÉO DE PROBLEMAS:
   ‚Ä¢ Tente "Impress√£o Direta" se a valida√ß√£o falhar
   ‚Ä¢ Verifique se o popup de impress√£o aparece
   ‚Ä¢ Teste em modo inc√≥gnito/privado
   ‚Ä¢ Atualize o navegador se necess√°rio

Deseja continuar com o teste?`;

            return confirm(tips);
        }

        // Fun√ß√£o melhorada de teste
        function testPrint() {
            console.log('üîß Iniciando diagn√≥stico completo...');
            
            // Verificar se todos os campos est√£o acess√≠veis
            const fieldsCheck = {
                doctorName: document.getElementById('doctorName')?.value || 'VAZIO',
                doctorCrm: document.getElementById('doctorCrm')?.value || 'VAZIO',
                doctorSpecialty: document.getElementById('doctorSpecialty')?.value || 'VAZIO',
                prescriptionDate: document.getElementById('prescriptionDate')?.value || 'VAZIO',
                patientName: document.getElementById('patientName')?.value || 'VAZIO',
                patientAge: document.getElementById('patientAge')?.value || 'VAZIO',
                patientWeight: document.getElementById('patientWeight')?.value || 'VAZIO',
                patientCpf: document.getElementById('patientCpf')?.value || 'VAZIO',
                patientPhone: document.getElementById('patientPhone')?.value || 'VAZIO',
                patientGender: document.getElementById('patientGender')?.value || 'VAZIO'
            };
            
            // Verificar medicamentos
            const medications = document.querySelectorAll('.medication-item');
            const medicationCheck = [];
            
            medications.forEach((med, index) => {
                const inputs = med.querySelectorAll('input');
                const select = med.querySelector('select');
                const textarea = med.querySelector('textarea');
                
                medicationCheck.push({
                    medicamento: index + 1,
                    nome: inputs[0]?.value || 'VAZIO',
                    quantidade: inputs[1]?.value || 'VAZIO', 
                    via: select?.value || 'VAZIO',
                    posologia: textarea?.value || 'VAZIO'
                });
            });
            
            // Verificar orienta√ß√µes gerais
            const generalInstructions = document.querySelector('.general-instructions textarea')?.value || 'VAZIO';
            
            const diagnosticReport = `
üîç RELAT√ìRIO DE DIAGN√ìSTICO COMPLETO:

üìã DADOS DO M√âDICO:
‚Ä¢ Nome: ${fieldsCheck.doctorName}
‚Ä¢ CRM: ${fieldsCheck.doctorCrm}
‚Ä¢ Especialidade: ${fieldsCheck.doctorSpecialty}
‚Ä¢ Data: ${fieldsCheck.prescriptionDate}

üë§ DADOS DO PACIENTE:
‚Ä¢ Nome: ${fieldsCheck.patientName}
‚Ä¢ Idade: ${fieldsCheck.patientAge}
‚Ä¢ Peso: ${fieldsCheck.patientWeight}
‚Ä¢ CPF: ${fieldsCheck.patientCpf}
‚Ä¢ Telefone: ${fieldsCheck.patientPhone}
‚Ä¢ Sexo: ${fieldsCheck.patientGender}

üíä MEDICAMENTOS:
${medicationCheck.map(med => 
    `‚Ä¢ Med ${med.medicamento}: ${med.nome} | Qtd: ${med.quantidade} | Via: ${med.via} | Posologia: ${med.posologia.substring(0, 50)}...`
).join('\n')}

üìù ORIENTA√á√ïES: ${generalInstructions.substring(0, 100)}...

‚úÖ MEDICAMENTOS V√ÅLIDOS: ${countValidMedications()}

Continuar com teste de impress√£o?`;

            console.log(diagnosticReport);
            
            if (confirm(diagnosticReport)) {
                console.log('üñ®Ô∏è Executando teste de impress√£o...');
                window.print();
            }
        }

        // Fun√ß√£o para debug dos campos
        function debugFields() {
            console.log('üêõ DEBUG - Verificando todos os campos...');
            
            // Listar todos os inputs
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach((field, index) => {
                console.log(`Campo ${index + 1}:`, {
                    type: field.tagName,
                    id: field.id || 'sem-id',
                    value: field.value || 'vazio',
                    placeholder: field.placeholder || 'sem-placeholder'
                });
            });
            
            // Verificar estrutura dos medicamentos
            const medications = document.querySelectorAll('.medication-item');
            console.log(`üìä Total de medicamentos encontrados: ${medications.length}`);
            
            medications.forEach((med, index) => {
                console.log(`Medicamento ${index + 1} estrutura:`, {
                    inputs: med.querySelectorAll('input').length,
                    selects: med.querySelectorAll('select').length,
                    textareas: med.querySelectorAll('textarea').length
                });
            });
        }

        // Vari√°vel para controlar tipo de marca d'√°gua
        let currentWatermark = 0;
        const watermarkTypes = ['main', 'logo', 'bordered', 'stamp', 'pattern', 'svg'];

        // Fun√ß√£o para alternar marca d'√°gua
        function toggleWatermark() {
            // Ocultar todas as marcas d'√°gua
            watermarkTypes.forEach(type => {
                const element = document.getElementById(`watermark-${type}`);
                if (element) {
                    element.classList.remove('watermark-preview');
                }
            });
            
            // Mostrar pr√≥xima marca d'√°gua
            currentWatermark = (currentWatermark + 1) % (watermarkTypes.length + 1);
            
            if (currentWatermark === 0) {
                alert('üíß Marca d\'√°gua DESATIVADA\n\nA impress√£o ser√° feita sem marca d\'√°gua.');
            } else {
                const activeType = watermarkTypes[currentWatermark - 1];
                const element = document.getElementById(`watermark-${activeType}`);
                if (element) {
                    element.classList.add('watermark-preview');
                }
                
                const watermarkNames = {
                    'main': 'LOPES SOUZA SA√öDE (Texto Principal)',
                    'logo': 'Logo LSS com Medicina',
                    'bordered': 'PRESCRI√á√ÉO OFICIAL (Com Bordas)',
                    'stamp': 'Carimbo M√©dico Oficial',
                    'pattern': 'Padr√£o M√∫ltiplo',
                    'svg': 'Imagem Profissional SVG'
                };
                
                alert(`üíß Marca d'√°gua ATIVADA\n\nTipo: ${watermarkNames[activeType]}\n\nEsta marca d'√°gua aparecer√° apenas na impress√£o.`);
            }
        }

        // Fun√ß√£o para preview da marca d'√°gua
        function previewWatermark() {
            if (currentWatermark > 0) {
                const activeType = watermarkTypes[currentWatermark - 1];
                const element = document.getElementById(`watermark-${activeType}`);
                if (element) {
                    element.classList.add('watermark-preview');
                    setTimeout(() => {
                        element.classList.remove('watermark-preview');
                    }, 3000);
                }
            }
        }

        // Inicializar marca d'√°gua padr√£o
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('prescriptionDate').value = today;
            
            // Ativar marca d'√°gua padr√£o (LOPES SOUZA SA√öDE)
            currentWatermark = 1;
            console.log('üíß Marca d\'√°gua padr√£o ativada: LOPES SOUZA SA√öDE');
        });
    </script>
</body>
</html>